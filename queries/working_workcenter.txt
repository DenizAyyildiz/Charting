WITH ASD as(
SELECT DISTINCT CASE WHEN IASPRDCONF.COSTCENTER =  'PRESHANE' THEN T.STAND
	   ELSE  IASPRDCONF.COSTCENTER  END AS COSTCENTER,CONFIRMDATE,IASPRDCONF.WORKCENTER FROM IASPRDCONF
LEFT JOIN IASWORKCENT T ON T.WORKCENTER =  IASPRDCONF.WORKCENTER AND T.ISDELETE = 0
WHERE  CONFIRMDATE > CAST(DATEADD(DAY,-30,GETDATE()) AS DATE)
AND IASPRDCONF.COSTCENTER IN ('CNC','TASLAMA','CNCTORNA','MONTAJ','PRESHANE'))
SELECT COSTCENTER,CONFIRMDATE,COUNT(WORKCENTER) as COUNTOFWC FROM ASD
GROUP BY CONFIRMDATE,COSTCENTER
ORDER BY COSTCENTER,CONFIRMDATE